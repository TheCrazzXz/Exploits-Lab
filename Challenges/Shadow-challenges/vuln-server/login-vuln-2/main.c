#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#define STACK_CANARY "VFGHM"
#define PASSWORD_BUFFER_SIZE 20

int login()
{
	char* name = malloc(20);
	printf("Enter your username : ");
	scanf("%s", name);
	
	char password[] = "Hello";
	char stack_canary[10] = STACK_CANARY;

	char buffer[PASSWORD_BUFFER_SIZE];
	
	printf("Hello, ");
	printf(name);
	printf("\n");

	printf("Enter your password : ");
	scanf("%s", buffer);
	
	//printf("`buffer` : %s\n", buffer);
	//printf("`password` : %s\n", password);
	//printf("`stack_canary` : [%s]\n", stack_canary);

	if(strcmp(stack_canary, STACK_CANARY) != 0)
	{
		printf("/!\\Detected stack buffer overflow !/!\\\nExiting...\n");
		exit(1);
	}

	if(strcmp(buffer, password) == 0)
	{
		return 1;
	}
	else
	{
		return 0;
	}
}

int main()
{
	int login_result = login();
	if(login_result == 1)
	{
		printf("Acces granted !\n");
	}
	else
	{
		printf("Acces denied !\n");
	}
}
