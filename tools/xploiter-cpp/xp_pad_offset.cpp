#include "xploiter.h"
#include <iostream>
#include <string>
#include <fstream>

int main(int argc, char* argv[])
{
	char elem;
	
	if(argc < 5)
	{
		std::cout << "Usage : xp_create_padding <element> <element:hex/ascii [h | a]> <repeat> <filename>";
		exit(-1);
	}
	if(argv[2][0] == 'h')
	{
		elem = (char) (int)strtol(argv[1], NULL, 16);
	}
	else
	{
		elem = argv[1][0];
	}
	
	std::string padding;
	std::ifstream file;
	file.open(argv[4]);
	file >> padding;
	std::vector<int> offsets = xploiter::getPaddingOffset(padding, elem, std::atoi(argv[3]));
	
	for(auto elem : offsets)
	{
		std::cout << "Offset at : " << elem << std::endl;
	}
}