# STACK PROTECTIONS
Nowadays, the stack is protected, it has some protections that can make exploitation extremely more complex  
These are the main peotections of the stack :
```
NX (non executable stack)
ASLR (Address space layout randomisation)
PIE (Position independant executable)
```
About memory segments/sections permissions
```
Memory sections are the stack (.stack), the heap (.heap), the executable code (.text) and more
These memory regions are made for different usages, so the stack to store and read data, same for the heap, the .text (code) to execute binary instructions...
And all segments do have permissions which are represented by different falgs (letters) : W (writable), R (Readable), X (Executable)
If a segment is writable, it means that we can store data in it
If a segment is readable, it means that we can get data from it
If a segment is executable, it means that we can execute data from it, so if there are binary shellcode, we could run it
So the stack and the heap have the flags WR (writable and readable)
The code (.text) has the flag X meaning that we can only execute it
```
About NX :
```
When NX is disabled, the X flag is added to the stack segment/section, so we can execute shellcode which can be stored in it
In GCC, to disable NX we can do so 
Add C flag "-z execstack" :  
gcc <src code.c> -o <executable> -z execstack
```
About ASLR :
```
ASLR will give to the program variables and dynamicly linked libraries like libc random addresses
So if we're looking for an address, it will be not possible to determine it because at each execution it will be random, so it's impossible to predict it
Note : ASLR does not apply to the .text segment and the staticly linked libraries
```
In linux, to disable ASLR :
```bash
echo 0 | sudo tee /proc/sys/kernel/randomize_va_space
```
Or to disable ALSR for the program only :
```bash
setarch `uname -m` -R <executable>
# When you wanna pipe the exploit : python exploit.py | setarch `uname -m` -R <executable>
```
About PIE :
```
PIE is a very similar protection to ASLR except it's for the .text segment  
In GCC, to disable PIE :  
Add C flag "-no-pie" :  
gcc <src code.c> -o <executable> -no-pie
```
https://youtu.be/akCce7vSSfw
