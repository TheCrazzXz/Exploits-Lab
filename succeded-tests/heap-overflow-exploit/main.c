#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <string.h>
#include <sys/types.h>

#define BUFSIZE 10
#define OVERSIZE 5 //Number of characters that `buf1` with overflow `buf2`

int main() {
	unsigned long diff;
	char *buf1 = (char *)malloc(BUFSIZE);
	char *buf2 = (char *)malloc(BUFSIZE);
	
	/*
		Will dynamicly allocate `buf1` and `buf` in 
		the heap with the size `BUFSIZE`
	*/
	
	diff = (unsigned long)buf2 - (unsigned long)buf1; //Substract the memory address of `buf1` with memory address of `buf`
	printf("diff = %lu bytes\n", diff);

	strcpy(buf2, "AAAAAAAAAA"); //Set `buf2` to "AAAAAAAAAA"
	printf("buf2 before heap overflow = %s\n", buf2); //Print the buffer

	memset(buf1, 'B', (unsigned int)(diff+OVERSIZE));
	//Fill buf1 with 'B' (diff + OVERSIZE) times
	printf("Diff : %d, Oversize, %d, Sum : %d\n", diff, OVERSIZE, diff+OVERSIZE);
	printf("buf2 after heap overflow = %s\n", buf2);
	
	free(buf1);
	free(buf2);
	
	return 0;
}
