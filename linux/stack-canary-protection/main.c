#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define STACK_CANARY "VFGHM"

int main(int argc, char** argv)
{		
	char* name = malloc(20);
	scanf("%s", name);
	
	char password[] = "Hello";
	char stack_canary[10] = STACK_CANARY;

	char buffer[20];
	scanf("%s", buffer);

	printf("Hello, ");
	printf(name);
	printf("\n");

	//printf("Enter your password : ");
	
	printf("`buffer` : %s\n", buffer);
	printf("`password` : %s\n", password);
	printf("`stack_canary` : [%s]\n", stack_canary);

	if(strcmp(stack_canary, STACK_CANARY) != 0)
	{
		printf("/!\\Detected stack buffer overflow !/!\\\nExiting...\n");
		exit(1);
	}

	if(strcmp(buffer, password) == 0)
	{
		printf("Acces granted\n");
	}
	else
	{
		printf("Acced denied\n");
	}
}