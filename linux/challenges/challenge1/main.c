#include <stdio.h>
#include <stdlib.h>
#include <string.h>
/*
	The goal of this challenge is to overwrite the global offset table with the target function
*/

#define VERSION 1.0
#define STACK_CANARY 0x905723
#define PASSWORD "ThinHack"
#define ID 0x01
#define BUFFER_SIZE 8

void correct_password()
{
	printf("Acces granted");
}
void incorrect_password()
{
	printf("Acces denied : Wrong password");
}
struct profile
{
	int id;
	char* buffer;
};

void process(char** argv)
{
	char user[] = "Oppa";
	char pass[] = PASSWORD;

	struct profile* username = malloc(sizeof(struct profile));
	username->id = ID;
	username->buffer = malloc(8);

	struct profile* password = malloc(sizeof(struct profile));
	password->id = ID;
	password->buffer = malloc(8);
	 
	strcpy(username->buffer, argv[1]);
  	strcpy(password->buffer, argv[2]);
	printf("You're logged\n");

	if(strcmp(username->buffer, user) == 0 && strcmp(password->buffer, pass) == 0)
	{
		correct_password();
	}
	else
	{
		incorrect_password();
	}
}

int main(int argc, char **argv)
{
	process(argv);
}

